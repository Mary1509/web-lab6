(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42ad8021"],{"0c72":function(e,t,n){"use strict";n("1168")},1168:function(e,t,n){},a4a2:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"containts"}},[n("div",{attrs:{id:"activeChat"}},[n("div",{attrs:{id:"chatHistory"}},[n("h2",[e._v("Messages")]),n("div",{attrs:{id:"text"}},[n("ul",e._l(e.messages,(function(t){return n("li",{key:t.id,class:[e.me===t.author.id?"ownerM":""]},[e._v(" "+e._s(t.text)+"|"+e._s(t.author.username)+"@"+e._s(t.timestamp)+" ")])})),0)]),n("div",{attrs:{id:"interact"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.newMessage,expression:"newMessage"}],attrs:{placeholder:"Your text here"},domProps:{value:e.newMessage},on:{input:function(t){t.target.composing||(e.newMessage=t.target.value)}}}),n("button",{attrs:{name:"Send"},on:{click:e.sendMessage}},[e._v("Send")])])]),n("div",{attrs:{id:"chatInfo"}},[n("h2",[e._v("Info")]),n("h3",[e._v(e._s(e.room.name))]),n("button",{attrs:{id:"exitBtn"},on:{click:e.exit}},[e._v("Exit")]),n("ul",{attrs:{id:"membersList"}},e._l(this.members,(function(t){return n("li",{key:t.id,class:[e.me===t.id?"ownerL":""]},[e._v(" "+e._s(t.username)+" ")])})),0),e.isOwner?n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.newName,expression:"newName"}],attrs:{placeholder:"Change name"},domProps:{value:e.newName},on:{input:function(t){t.target.composing||(e.newName=t.target.value)}}}),n("button",{on:{click:function(t){return e.change()}}},[e._v("Change")]),n("button",{attrs:{name:"del"},on:{click:function(t){return e.deleteRoom()}}},[e._v("Delete chat")])]):e._e()])])])},a=[],s=n("1da1"),o=(n("96cf"),n("a434"),n("b0c0"),n("4868")),i={name:"ActiveChat",props:["room"],data:function(){return{members:this.room.members,messages:this.room.lastMessages,me:this.$parent.me.id,newMessage:"",newName:""}},computed:{isOwner:function(){return this.$parent.me.id===this.room.owner.id}},apollo:{$subscribe:{messageCreated:{query:o["k"],result:function(e){var t=e.data,n=t.messageCreated;console.log(n),0===n.room.id.localeCompare(this.room.id)&&this.messages.push(n)}},memberJoined:{query:o["i"],result:function(e){var t=e.data,n=t.memberJoined;this.room.members.push(n)}},memberLeft:{query:o["j"],result:function(e){var t=e.data,n=t.memberLeft;for(var r in console.log(t),this.members)if(parseInt(r.id)===parseInt(n.id)){var a=this.members.indexOf(n.id);this.room.members.splice(a,1)}}},currentRoomChanged:{query:o["b"],result:function(e){var t=e.data,n=t.currentRoomChanged;for(var r in console.log(t),this.room.members)parseInt(r.id)===parseInt(n.id)&&(r=n)}}}},methods:{sendMessage:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$apollo.mutate({mutation:o["p"],variables:{message:e.newMessage}});case 2:case"end":return t.stop()}}),t)})))()},change:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$apollo.mutate({mutation:o["q"],variables:{id:e.room.id,name:e.newName}});case 2:n=t.sent,console.log(n),e.room.name=n.data.updateRoom.name;case 5:case"end":return t.stop()}}),t)})))()},deleteRoom:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.exit(),t.next=3,e.$apollo.mutate({mutation:o["c"],variables:{id:e.room.id}});case 3:case"end":return t.stop()}}),t)})))()},exit:function(){this.$apollo.subscriptions.messageCreated.stop(),this.$apollo.subscriptions.memberJoined.stop(),this.$apollo.subscriptions.memberLeft.stop(),this.$apollo.subscriptions.currentRoomChanged.stop(),console.log(this.$apollo.getClient()),console.log("may be stopped"),this.$emit("exit")}}},m=i,u=(n("0c72"),n("2877")),c=Object(u["a"])(m,r,a,!1,null,"6d848095",null);t["default"]=c.exports},b0c0:function(e,t,n){var r=n("83ab"),a=n("9bf2").f,s=Function.prototype,o=s.toString,i=/^\s*function ([^ (]*)/,m="name";r&&!(m in s)&&a(s,m,{configurable:!0,get:function(){try{return o.call(this).match(i)[1]}catch(e){return""}}})}}]);
//# sourceMappingURL=chunk-42ad8021.4fded649.js.map